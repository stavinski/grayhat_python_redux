#!/usr/bin/python
import ctypes

# different shellcodes to execute
msg_box = "\x48\x83\xEC\x28\x48\x83\xE4\xF0\x48\x8D\x15\x66\x00\x00\x00\x48\x8D\x0D\x52\x00\x00\x00\xE8\x9E\x00\x00\x00\x4C\x8B\xF8\x48\x8D\x0D\x5D\x00\x00\x00\xFF\xD0\x48\x8D\x15\x5F\x00\x00\x00\x48\x8D\x0D\x4D\x00\x00\x00\xE8\x7F\x00\x00\x00\x4D\x33\xC9\x4C\x8D\x05\x61\x00\x00\x00\x48\x8D\x15\x4E\x00\x00\x00\x48\x33\xC9\xFF\xD0\x48\x8D\x15\x56\x00\x00\x00\x48\x8D\x0D\x0A\x00\x00\x00\xE8\x56\x00\x00\x00\x48\x33\xC9\xFF\xD0\x4B\x45\x52\x4E\x45\x4C\x33\x32\x2E\x44\x4C\x4C\x00\x4C\x6F\x61\x64\x4C\x69\x62\x72\x61\x72\x79\x41\x00\x55\x53\x45\x52\x33\x32\x2E\x44\x4C\x4C\x00\x4D\x65\x73\x73\x61\x67\x65\x42\x6F\x78\x41\x00\x48\x65\x6C\x6C\x6F\x20\x77\x6F\x72\x6C\x64\x00\x4D\x65\x73\x73\x61\x67\x65\x00\x45\x78\x69\x74\x50\x72\x6F\x63\x65\x73\x73\x00\x48\x83\xEC\x28\x65\x4C\x8B\x04\x25\x60\x00\x00\x00\x4D\x8B\x40\x18\x4D\x8D\x60\x10\x4D\x8B\x04\x24\xFC\x49\x8B\x78\x60\x48\x8B\xF1\xAC\x84\xC0\x74\x26\x8A\x27\x80\xFC\x61\x7C\x03\x80\xEC\x20\x3A\xE0\x75\x08\x48\xFF\xC7\x48\xFF\xC7\xEB\xE5\x4D\x8B\x00\x4D\x3B\xC4\x75\xD6\x48\x33\xC0\xE9\xA8\x00\x00\x00\x49\x8B\x58\x30\x44\x8B\x4B\x3C\x4C\x03\xCB\x49\x81\xC1\x88\x00\x00\x00\x45\x8B\x29\x4D\x85\xED\x75\x08\x48\x33\xC0\xE9\x86\x00\x00\x00\x4D\x8D\x44\x1D\x00\x45\x8B\x71\x04\x4D\x03\xF5\x41\x8B\x48\x18\x45\x8B\x50\x20\x4C\x03\xD3\xFF\xC9\x4D\x8D\x0C\x8A\x41\x8B\x39\x48\x03\xFB\x48\x8B\xF2\xA6\x75\x08\x8A\x06\x84\xC0\x74\x09\xEB\xF5\xE2\xE6\x48\x33\xC0\xEB\x4E\x45\x8B\x48\x24\x4C\x03\xCB\x66\x41\x8B\x0C\x49\x45\x8B\x48\x1C\x4C\x03\xCB\x41\x8B\x04\x89\x49\x3B\xC5\x7C\x2F\x49\x3B\xC6\x73\x2A\x48\x8D\x34\x03\x48\x8D\x7C\x24\x30\x4C\x8B\xE7\xA4\x80\x3E\x2E\x75\xFA\xA4\xC7\x07\x44\x4C\x4C\x00\x49\x8B\xCC\x41\xFF\xD7\x49\x8B\xCC\x48\x8B\xD6\xE9\x13\xFF\xFF\xFF\x48\x03\xC3\x48\x83\xC4\x28\xC3"
#taskkiller = "\x48\x83\xec\x28\x48\x83\xe4\xf0\x48\x8d\x15\x57\x20\x20\x20\x48\x8d\x0d\x43\x20\x20\x20\xe8\xa3\x20\x20\x20\x4c\x8b\xf8\x48\x8d\x15\x4e\x20\x20\x20\x48\x8d\x0d\x2d\x20\x20\x20\xe8\x8d\x20\x20\x20\x48\xc7\xc2\x20\x20\x20\x20\x48\x8d\x0d\x3c\x20\x20\x20\xff\xd0\x48\x8d\x15\x6a\x20\x20\x20\x48\x8d\x0d\x0a\x20\x20\x20\xe8\x6a\x20\x20\x20\x48\x33\xc9\xff\xd0\x4b\x45\x52\x4e\x45\x4c\x33\x32\x2e\x44\x4c\x4c\x20\x4c\x6f\x61\x64\x4c\x69\x62\x72\x61\x72\x79\x41\x20\x57\x69\x6e\x45\x78\x65\x63\x20\x43\x3a\x5c\x57\x69\x6e\x64\x6f\x77\x73\x5c\x53\x79\x73\x74\x65\x6d\x33\x32\x5c\x74\x61\x73\x6b\x6b\x69\x6c\x6c\x2e\x65\x78\x65\x20\x2f\x70\x69\x64\x20\x41\x41\x41\x41\x41\x20\x45\x78\x69\x74\x54\x68\x72\x65\x61\x64\x20\x45\x78\x69\x74\x50\x72\x6f\x63\x65\x73\x73\x20\x48\x83\xec\x28\x65\x4c\x8b\x04\x25\x60\x20\x20\x20\x4d\x8b\x40\x18\x4d\x8d\x60\x10\x4d\x8b\x04\x24\xfc\x49\x8b\x78\x60\x48\x8b\xf1\xac\x84\xc0\x74\x26\x8a\x27\x80\xfc\x61\x7c\x03\x80\xec\x20\x3a\xe0\x75\x08\x48\xff\xc7\x48\xff\xc7\xeb\xe5\x4d\x8b\x20\x4d\x3b\xc4\x75\xd6\x48\x33\xc0\xe9\xa8\x20\x20\x20\x49\x8b\x58\x30\x44\x8b\x4b\x3c\x4c\x03\xcb\x49\x81\xc1\x88\x20\x20\x20\x45\x8b\x29\x4d\x85\xed\x75\x08\x48\x33\xc0\xe9\x86\x20\x20\x20\x4d\x8d\x44\x1d\x20\x45\x8b\x71\x04\x4d\x03\xf5\x41\x8b\x48\x18\x45\x8b\x50\x20\x4c\x03\xd3\xff\xc9\x4d\x8d\x0c\x8a\x41\x8b\x39\x48\x03\xfb\x48\x8b\xf2\xa6\x75\x08\x8a\x06\x84\xc0\x74\x09\xeb\xf5\xe2\xe6\x48\x33\xc0\xeb\x4e\x45\x8b\x48\x24\x4c\x03\xcb\x66\x41\x8b\x0c\x49\x45\x8b\x48\x1c\x4c\x03\xcb\x41\x8b\x04\x89\x49\x3b\xc5\x7c\x2f\x49\x3b\xc6\x73\x2a\x48\x8d\x34\x03\x48\x8d\x7c\x24\x30\x4c\x8b\xe7\xa4\x80\x3e\x2e\x75\xfa\xa4\xc7\x07\x44\x4c\x4c\x20\x49\x8b\xcc\x41\xff\xd7\x49\x8b\xcc\x48\x8b\xd6\xe9\x13\xff\xff\xff\x48\x03\xc3\x48\x83\xc4\x28\xc3"


shell_code = bytearray(msg_box)

ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0),
                                          ctypes.c_int(len(shell_code)),
                                          ctypes.c_int(0x3000),
                                          ctypes.c_int(0x40))

buf = (ctypes.c_char * len(shell_code)).from_buffer(shell_code)

ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(ptr),
                                     buf,
                                     ctypes.c_int(len(shell_code)))

ht = ctypes.windll.kernel32.CreateThread(ctypes.c_int(0),
                                         ctypes.c_int(0),
                                         ctypes.c_int(ptr),
                                         ctypes.c_int(0),
                                         ctypes.c_int(0),
                                         ctypes.pointer(ctypes.c_int(0)))

ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(ht), ctypes.c_int(-1))
